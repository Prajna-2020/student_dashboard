{% extends 'faculty/base.html' %}
{% block content %}
<div class="content-wrapper">
  <div class="row">
    <div class="col-md-12 grid-margin">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <h4 class="font-weight-bold mb-0">FACULTY DASHBOARD</h4>
        </div>
      </div>
    </div>
  </div>

  <!-- Faculty Info Cards -->
  <div class="row mb-4">
    <div class="col-md-3 mb-4">
      <div class="card dashboard-card h-100">
        <div class="card-body">
          <p class="card-title text-md-center text-xl-left">User ID</p>
          <div class="d-flex flex-wrap justify-content-between justify-content-md-center justify-content-xl-between align-items-center">
            <h4 class="mb-0 mb-md-2 mb-xl-0 order-md-1 order-xl-0 text-truncate">{{ request.user }}</h4>
            <i class="ti-write icon-md text-muted mb-0 mb-md-3 mb-xl-0"></i>
          </div>  
        </div>
      </div>
    </div>
    <div class="col-md-3 mb-4">
      <div class="card dashboard-card h-100">
        <div class="card-body">
          <p class="card-title text-md-center text-xl-left">Faculty Name</p>
          <div class="d-flex flex-wrap justify-content-between justify-content-md-center justify-content-xl-between align-items-center">
            <h4 class="mb-0 mb-md-2 mb-xl-0 order-md-1 order-xl-0 text-truncate">{{ request.user.get_full_name }}</h4>
            <i class="ti-user icon-md text-muted mb-0 mb-md-3 mb-xl-0"></i>
          </div>  
        </div>
      </div>
    </div>
    <div class="col-md-3 mb-4">
      <div class="card dashboard-card h-100">
        <div class="card-body">
          <p class="card-title text-md-center text-xl-left">Department</p>
          <div class="d-flex flex-wrap justify-content-between justify-content-md-center justify-content-xl-between align-items-center">
            <h4 class="mb-0 mb-md-2 mb-xl-0 order-md-1 order-xl-0 text-truncate">{{ request.user.faculty.department.department_name }}</h4>
            <i class="ti-bookmark icon-md text-muted mb-0 mb-md-3 mb-xl-0"></i>
          </div>  
        </div>
      </div>
    </div>
    <div class="col-md-3 mb-4">
      <div class="card dashboard-card h-100">
        <div class="card-body">
          <p class="card-title text-md-center text-xl-left">Position</p>
          <div class="d-flex flex-wrap justify-content-between justify-content-md-center justify-content-xl-between align-items-center">
            <h4 class="mb-0 mb-md-2 mb-xl-0 order-md-1 order-xl-0 text-truncate">{{ request.user.faculty.employee_position }}</h4>
            <i class="ti-alert icon-md text-muted mb-0 mb-md-3 mb-xl-0"></i>
          </div>  
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  
  <!-- Statistics Cards -->
  <div class="row mb-4">
    <div class="col-md-6 col-lg-3 mb-4">
      <div class="card border-left-primary shadow h-100">
        <div class="card-body py-3">
          <div class="d-flex align-items-center">
            <div class="mr-3">
              <i class="fas fa-users fa-2x text-gray-300"></i>
            </div>
            <div>
              <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                Total Students</div>
              <div class="h5 mb-0 font-weight-bold text-gray-800">{{ total_students }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-6 col-lg-3 mb-4">
      <div class="card border-left-success shadow h-100">
        <div class="card-body py-3">
          <div class="d-flex align-items-center">
            <div class="mr-3">
              <i class="fas fa-chalkboard-teacher fa-2x text-gray-300"></i>
            </div>
            <div>
              <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                Total Faculty</div>
              <div class="h5 mb-0 font-weight-bold text-gray-800">{{ total_faculty }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-6 col-lg-3 mb-4">
      <div class="card border-left-info shadow h-100">
        <div class="card-body py-3">
          <div class="d-flex align-items-center">
            <div class="mr-3">
              <i class="fas fa-book fa-2x text-gray-300"></i>
            </div>
            <div>
              <div class="text-xs font-weight-bold text-info text-uppercase mb-1">
                Your Courses</div>
              <div class="h5 mb-0 font-weight-bold text-gray-800">{{ faculty_courses_count }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-6 col-lg-3 mb-4">
      <div class="card border-left-warning shadow h-100">
        <div class="card-body py-3">
          <div class="d-flex align-items-center">
            <div class="mr-3">
              <i class="fas fa-user-graduate fa-2x text-gray-300"></i>
            </div>
            <div>
              <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                Your Students</div>
              <div class="h5 mb-0 font-weight-bold text-gray-800">{{ faculty_students_count }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row mb-4">
    <div class="col-md-12">
      <div class="card dashboard-card">
        <div class="card-body">
          <h4 class="card-title mb-4">Quick Actions</h4>
          <div class="row">
            <div class="col-6 col-md-3 mb-3 mb-md-0">
              <a href="/fac_course/" class="btn btn-primary btn-block btn-rounded py-2">
                <i class="ti-book mr-2"></i> View Courses
              </a>
            </div>
            <div class="col-6 col-md-3 mb-3 mb-md-0">
              <a href="{% url 'course_actions' 'attendance' %}" class="btn btn-success btn-block btn-rounded py-2">
                <i class="ti-check-box mr-2"></i> Mark Attendance
              </a>
            </div>
            <div class="col-6 col-md-3 mb-3 mb-md-0">
              <a href="{% url 'course_actions' 'results' %}" class="btn btn-info btn-block btn-rounded py-2">
                <i class="ti-clipboard mr-2"></i> Enter Results
              </a>
            </div>
            <div class="col-6 col-md-3">
              <a href="{% url 'post_announcement' %}" class="btn btn-warning btn-block btn-rounded py-2">
                <i class="ti-announcement mr-2"></i> Post Announcement
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


  <!-- Today's Attendance and Recent Activities -->
  <div class="row mb-4">
    <div class="col-lg-6 mb-4">
      <div class="card shadow h-100">
        <div class="card-header py-3 d-flex justify-content-between align-items-center">
          <h6 class="m-0 font-weight-bold text-primary">Today's Attendance Summary</h6>
          <span class="badge bg-primary text-white">{{ today|date:"F j, Y" }}</span>
        </div>
        <div class="card-body">
          <div class="row text-center">
            <div class="col-md-6 mb-3 mb-md-0">
              <div class="text-success mb-2">
                <i class="fas fa-check-circle fa-3x"></i>
              </div>
              <h3 class="text-success mb-1">{{ today_attendance.present }}</h3>
              <p class="mb-0 text-muted">Present Students</p>
            </div>
            <div class="col-md-6">
              <div class="text-danger mb-2">
                <i class="fas fa-times-circle fa-3x"></i>
              </div>
              <h3 class="text-danger mb-1">{{ today_attendance.absent }}</h3>
              <p class="mb-0 text-muted">Absent Students</p>
            </div>
          </div>
          <div class="mt-4 text-center">
            <a href="{% url 'course_actions' 'attendance' %}" class="btn btn-primary btn-sm">
              <i class="fas fa-calendar-check mr-2"></i> Manage Attendance
            </a>
          </div>
        </div>
      </div>
    </div>

    <div class="col-lg-6 mb-4">
      <div class="card shadow h-100">
        <div class="card-header py-3">
          <h6 class="m-0 font-weight-bold text-primary">Recent Activities</h6>
          <span class="badge bg-info text-white">{{ today_activities_count }} today</span>
        </div>
        <div class="card-body p-0">
      <div class="list-group list-group-flush" style="max-height: 300px; overflow-y: auto;">
        {% for activity in recent_activities %}
        <div class="list-group-item list-group-item-action">
          <div class="d-flex w-100 justify-content-between">
            <h6 class="mb-1">{{ activity.description }}</h6>
            <small class="text-muted">
              {% if activity.date == today %}
                Today
              {% else %}
                {{ activity.date|date:"M d" }}
              {% endif %}
            </small>
          </div>
          <p class="mb-1">{{ activity.details }}</p>
          {% if activity.type == 'attendance' %}
          <span class="badge bg-{% if activity.object.status == 'Present' %}success{% else %}danger{% endif %}">
            {{ activity.object.status }}
          </span>
          {% endif %}
        </div>
        {% empty %}
        <div class="text-center py-4 text-muted">
          <i class="fas fa-info-circle fa-2x mb-2"></i>
          <p>No recent activities found</p>
        </div>
        {% endfor %}
      </div>
    </div>
  
      </div>
    </div>
  

  <!-- Courses Section -->
  

  <!-- Search Results (if any) -->
  <!-- Search Results (if any) -->

</div>

<style>
  /* Additional fixes for alignment */
  .card {
    border-radius: 0.5rem;
  }
  .card-body {
    padding: 1.25rem;
  }
  .card-title {
    font-size: 1rem;
    margin-bottom: 0.5rem;
  }
  .btn-rounded {
    border-radius: 50px;
  }
  .list-group-item {
    border-left: 0;
    border-right: 0;
  }
  .list-group-item:first-child {
    border-top: 0;
  }
  .list-group-item:last-child {
    border-bottom: 0;
  }
  .h-100 {
    height: 100%;
  }
  .text-truncate {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .badge {
    padding: 0.35em 0.65em;
    font-weight: 500;
  }
</style>
{% endblock %}